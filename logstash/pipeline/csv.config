input {
  file {
    path => ["/usr/share/walaniam/stock/data/mstcgl/PKOBP.mst"]
    sincedb_path => "/dev/null"
    start_position => "beginning"
  }
}

filter {  
  csv {
    columns => ["<TICKER>","<DTYYYYMMDD>","<OPEN>","<HIGH>","<LOW>","<CLOSE>", "<VOL>"]
  }
  mutate {
   rename => {
     "<TICKER>" => "ticker"
     "<DTYYYYMMDD>" => "date"
     "<OPEN>" => "open"
     "<HIGH>" => "high"
     "<LOW>" => "low"
     "<CLOSE>" => "close"
     "<VOL>" => "vol"
   }
   lowercase => [ "ticker" ]
  }
}

output {
  elasticsearch { 
    hosts => ["elasticsearch:9200"] 
    index => "stock-%{[ticker]}"
  }
  stdout { codec => rubydebug }
}
